<section class="wrap space-y-8">
  <!-- Title -->
  <header class="pt-4">
    <h1 class="text-3xl md:text-4xl font-extrabold">
      Browse <span class="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-300">Programs</span>
    </h1>
    <p class="text-white/70 mt-1">
      Filter by goal, level, or vibe. Every plan is coach-designed and progress-tracked.
    </p>
  </header>

  <!-- Controls -->
  <div class="grid md:grid-cols-[1fr_auto_auto_auto] gap-3 items-center">
    <!-- search -->
    <div class="relative">
      <input
        type="search"
        (input)="onQuery($event)"
        [value]="q()"
        placeholder="Search: strength, HIIT, mobility, coach…"
        class="w-full rounded-xl bg-white/5 border border-white/10 px-4 py-3 outline-none focus:border-emerald-400/50"
      />
      <span class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-white/40 text-sm">⌘K</span>
    </div>

    <!-- level -->
    <select
      class="rounded-xl bg-white/5 border border-white/10 px-3 py-3 outline-none hover:bg-white/10"
      (change)="onLevelChange($event)"
      [value]="level()"
      title="Level"
    >
      <option value="All">All levels</option>
      <option value="Beginner">Beginner</option>
      <option value="Intermediate">Intermediate</option>
      <option value="Advanced">Advanced</option>
    </select>

    <!-- sort -->
    <select
      class="rounded-xl bg-white/5 border border-white/10 px-3 py-3 outline-none hover:bg-white/10"
      (change)="onSortChange($event)"
      [value]="sort()"
      title="Sort"
    >
      <option value="popular">Most popular</option>
      <option value="minutes-asc">Shortest first</option>
      <option value="minutes-desc">Longest first</option>
    </select>

    <!-- reset -->
    <button
      class="rounded-xl px-4 py-3 bg-white/5 border border-white/10 hover:bg-white/10"
      (click)="clearFilters()"
    >
      Reset
    </button>
  </div>

  <!-- tag chips -->
  <div class="flex flex-wrap gap-2">
    <button
      class="chip"
      [class.chip--active]="!tag()"
      (click)="tag.set(null)"
    >All</button>

    <button
      *ngFor="let t of allTags"
      class="chip"
      [class.chip--active]="tag() === t"
      (click)="tag.set(t)"
    >
      {{ t }}
    </button>
  </div>

  <!-- results -->
  <div *ngIf="programs().length; else nores"
       class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
    <article *ngFor="let p of programs()"
             class="card group">
      <div class="card__img" [style.backgroundImage]="'url(' + p.hero + ')'"></div>

      <div class="p-5">
        <div class="flex items-center justify-between gap-2">
          <h3 class="font-semibold text-lg leading-tight">{{ p.title }}</h3>
          <span class="pill">{{ p.level }}</span>
        </div>

        <p class="text-sm text-white/70 mt-1">{{ p.tagline }}</p>

        <div class="mt-4 flex flex-wrap items-center gap-2 text-xs text-white/60">
          <span class="badge">{{ p.minutes }} min</span>
          <span class="badge">{{ p.daysPerWeek }}d/week</span>
          <span class="badge">Coach {{ p.coach }}</span>
        </div>

        <div class="mt-3 flex flex-wrap gap-2">
          <span *ngFor="let t of p.tags" class="tag">{{ t }}</span>
        </div>

        <div class="mt-5 flex items-center gap-2">
          <a [routerLink]="['/signup']" class="btn btn--primary">Start free</a>
          <a [routerLink]="['/programs', p.id]" class="btn">Details</a>
        </div>
      </div>
    </article>
  </div>

  <ng-template #nores>
    <div class="rounded-xl border border-white/10 bg-white/5 p-8 text-center text-white/70">
      No programs match your filters. Try clearing a filter or searching a different term.
    </div>
  </ng-template>
</section>
